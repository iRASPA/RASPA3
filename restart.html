<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RASPA3: Restart</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RASPA3<span id="projectnumber">&#160;3.0.9</span>
   </div>
   <div id="projectbrief">A molecular simulation code for computing adsorption and diffusion in nanoporous materials</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('restart.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Restart</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Writing restart-files</h1>
<p>Restart-files are automatically written (and updated every 5000 cycles). Consider for example the following Gibbs-ensemble simulation </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;SimulationType&quot; : &quot;MonteCarlo&quot;,</div>
<div class="line">  &quot;NumberOfCycles&quot; : 25000,</div>
<div class="line">  &quot;NumberOfInitializationCycles&quot; : 10000,</div>
<div class="line">  &quot;PrintEvery&quot; : 1000,</div>
<div class="line"> </div>
<div class="line">  &quot;Systems&quot; :</div>
<div class="line">  [</div>
<div class="line">    {</div>
<div class="line">      &quot;Type&quot; : &quot;Box&quot;,</div>
<div class="line">      &quot;BoxLengths&quot; : [30.0, 30.0, 30.0],</div>
<div class="line">      &quot;ExternalTemperature&quot; : 240.0,</div>
<div class="line">      &quot;ChargeMethod&quot; : &quot;Ewald&quot;,</div>
<div class="line">      &quot;GibbsVolumeMoveProbability&quot; : 0.01</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      &quot;Type&quot; : &quot;Box&quot;,</div>
<div class="line">      &quot;BoxLengths&quot; : [30.0, 30.0, 30.0],</div>
<div class="line">      &quot;ExternalTemperature&quot; : 240.0,</div>
<div class="line">      &quot;ChargeMethod&quot; : &quot;Ewald&quot;,</div>
<div class="line">      &quot;GibbsVolumeMoveProbability&quot; : 0.01</div>
<div class="line">    }</div>
<div class="line">  ],</div>
<div class="line"> </div>
<div class="line">  &quot;Components&quot; :</div>
<div class="line">  [</div>
<div class="line">    {</div>
<div class="line">      &quot;Name&quot; : &quot;CO2&quot;,</div>
<div class="line">      &quot;MoleculeDefinition&quot; : &quot;ExampleDefinitions&quot;,</div>
<div class="line">      &quot;TranslationProbability&quot; : 0.5,</div>
<div class="line">      &quot;RotationProbability&quot; : 0.5,</div>
<div class="line">      &quot;ReinsertionProbability&quot; : 0.5,</div>
<div class="line">      &quot;GibbsSwapProbability&quot; : 1.0,</div>
<div class="line">      &quot;CreateNumberOfMolecules&quot; : [256, 256]</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p> At the end of the simulation you will find in the <code>output</code>-directory the files </p><div class="fragment"><div class="line">output/restart_240_0.s0.json</div>
<div class="line">output/restart_240_0.s1.json</div>
</div><!-- fragment --><hr  />
<h1>Using restart-files</h1>
<p>To use these restart-files to start from the saved (and hopefully equilibrated) postions, first copy these files to the working directory (the location of the <code>simulation.json</code>). </p><div class="fragment"><div class="line">cp output\restart_240_0.s0.json .</div>
<div class="line">cp output\restart_240_0.s1.json .</div>
</div><!-- fragment --><p> This is because the restart-files in the output-directory are overwritten every run. Next change the <code>simulation.json</code> to use the restart-files</p>
<p>The contents of the restart files look like </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;CO2&quot;: [</div>
<div class="line">    [ 16.640068355882505, 9.764919807611305, 4.333198721377549 ],</div>
<div class="line">    [ 17.15733718188185, 8.82872907970449, 4.75293778631024 ],</div>
<div class="line">    [ 17.67460600788119, 7.892538351797674, 5.172676851242931 ],</div>
<div class="line">    [ 3.815549021105568, 8.879311693833092, 17.616704775297364 ],</div>
<div class="line">    [ 4.677375964586537, 8.549547910646638, 18.30132961182377 ],</div>
<div class="line">    [ 5.539202908067507, 8.219784127460183, 18.985954448350178 ]</div>
<div class="line">  ],</div>
<div class="line">  &quot;SimulationBox&quot;: {</div>
<div class="line">    &quot;angle-alpha&quot;: 90.0,</div>
<div class="line">    &quot;angle-beta&quot;: 90.0,</div>
<div class="line">    &quot;angle-gamma&quot;: 90.0,</div>
<div class="line">    &quot;length-a&quot;: 31.881622110825266,</div>
<div class="line">    &quot;length-b&quot;: 31.881622110825266,</div>
<div class="line">    &quot;length-c&quot;: 31.881622110825266</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> So, the component-name as the key, and the value is an array of positions, and information on the simulation-box (during NPT or Gibbs the box changes). CO$_2$ molecules are usually modeled as <code>rigid</code> and implemented using quaternions. </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;CriticalTemperature&quot;: 304.1282,</div>
<div class="line">  &quot;CriticalPressure&quot;: 7377300.0,</div>
<div class="line">  &quot;AcentricFactor&quot;: 0.22394,</div>
<div class="line">  &quot;Type&quot;: &quot;rigid&quot;,</div>
<div class="line">  &quot;pseudoAtoms&quot;: [</div>
<div class="line">    [&quot;O_co2&quot;, [0.0, 0.0, 1.149]],</div>
<div class="line">    [&quot;C_co2&quot;, [0.0, 0.0, 0.0]],</div>
<div class="line">    [&quot;O_co2&quot;, [0.0, 0.0, -1.149]]</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p> The quaternions are computed from the positions using singular-value decompositions. The advantage is that, even when the positions are input by hand and do not satisfy the rigid constraints, an optimal mapping or best fit is obtained. For output restart-files, reading these in, should result in the exact same positions and energies.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;SimulationType&quot; : &quot;MonteCarlo&quot;,</div>
<div class="line">  &quot;NumberOfCycles&quot; : 25000,</div>
<div class="line">  &quot;NumberOfInitializationCycles&quot; : 1000,</div>
<div class="line">  &quot;PrintEvery&quot; : 1000,</div>
<div class="line"> </div>
<div class="line">  &quot;Systems&quot; :</div>
<div class="line">  [</div>
<div class="line">    {</div>
<div class="line">      &quot;Type&quot; : &quot;Box&quot;,</div>
<div class="line">      &quot;BoxLengths&quot; : [30.0, 30.0, 30.0],</div>
<div class="line">      &quot;ExternalTemperature&quot; : 240.0,</div>
<div class="line">      &quot;ChargeMethod&quot; : &quot;Ewald&quot;,</div>
<div class="line">      &quot;GibbsVolumeMoveProbability&quot; : 0.01,</div>
<div class="line">      &quot;RestartFileName&quot; : &quot;restart_240_0.s0&quot;</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      &quot;Type&quot; : &quot;Box&quot;,</div>
<div class="line">      &quot;BoxLengths&quot; : [30.0, 30.0, 30.0],</div>
<div class="line">      &quot;ExternalTemperature&quot; : 240.0,</div>
<div class="line">      &quot;ChargeMethod&quot; : &quot;Ewald&quot;,</div>
<div class="line">      &quot;GibbsVolumeMoveProbability&quot; : 0.01,</div>
<div class="line">      &quot;RestartFileName&quot; : &quot;restart_240_0.s1&quot;</div>
<div class="line">    }</div>
<div class="line">  ],</div>
<div class="line"> </div>
<div class="line">  &quot;Components&quot; :</div>
<div class="line">  [</div>
<div class="line">    {</div>
<div class="line">      &quot;Name&quot; : &quot;CO2&quot;,</div>
<div class="line">      &quot;MoleculeDefinition&quot; : &quot;ExampleDefinitions&quot;,</div>
<div class="line">      &quot;TranslationProbability&quot; : 0.5,</div>
<div class="line">      &quot;RotationProbability&quot; : 0.5,</div>
<div class="line">      &quot;ReinsertionProbability&quot; : 0.5,</div>
<div class="line">      &quot;GibbsSwapProbability&quot; : 1.0,</div>
<div class="line">      &quot;CreateNumberOfMolecules&quot; : [0, 0]</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p> Note because the positions are already equilibrated in this case, you can lower the amount of initialization cycles. This is the main point of using restart-file. But if you use the files to run at different conditions (for example a different temperature) you would still need a significant amount of initialization cycles.</p>
<p>The number of <code>CreateNumberOfMolecules</code> should be put to zero, since the molecules are read from the restart-files. However, you still have the freedom to create additional molecules on top of what was read from the restart-files. This might be usefull to construct very high density systems.</p>
<hr  />
<h1>Using binary-restart-files</h1>
<p>Binary restart-files are usefull in case of system crashes or limits on running-times in computer clusters. By continuing from the binary restart-file you would get identical results are running the long job, i.e. it contains the entire state of the simulation. Note that therefore whatever you change in the <code>simulation.json</code> is ignored since it uses the state from the binary restart-file.</p>
<p>During the simulation a file named <code>restart_data.bin</code> is written out. The option to continue from this file is </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;RestartFromBinaryFile&quot; : &quot;true&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p> Note not everything can be recovered, like written pdb-movies. The setting </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;WriteBinaryRestartEvery&quot; : &quot;5000&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p> controls how often the file is written out. The default is every 5000 cycles. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="md_docs_2manual.html">User Manual</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
