<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RASPA3: TransitionMatrix Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RASPA3<span id="projectnumber">&#160;3.0.6</span>
   </div>
   <div id="projectbrief">A molecular simulation code for computing adsorption and diffusion in nanoporous materials</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structTransitionMatrix.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="structTransitionMatrix-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">TransitionMatrix Struct Reference<span class="mlabels"><span class="mlabel">export</span></span><div class="ingroups">module <a class="el" href="module_transition__matrix.html">transition_matrix</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Represents the transition matrix for TMMC simulations.  
 <a href="structTransitionMatrix.html#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for TransitionMatrix:</div>
<div class="dyncontent">
<div class="center"><img src="structTransitionMatrix__coll__graph.png" border="0" usemap="#aTransitionMatrix_coll__map" alt="Collaboration graph"/></div>
<map name="aTransitionMatrix_coll__map" id="aTransitionMatrix_coll__map">
<area shape="rect" title="Represents the transition matrix for TMMC simulations." alt="" coords="222,137,349,163"/>
<area shape="rect" title=" " alt="" coords="5,5,179,31"/>
<area shape="poly" title=" " alt="" coords="120,37,227,111,266,135,264,140,224,116,117,41"/>
<area shape="rect" title=" " alt="" coords="203,5,368,31"/>
<area shape="poly" title=" " alt="" coords="288,44,288,137,283,137,283,44"/>
<area shape="rect" title=" " alt="" coords="393,5,551,31"/>
<area shape="poly" title=" " alt="" coords="455,43,419,80,373,116,323,140,321,135,371,111,415,76,451,40"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab7b1f21c7017042806199c7858446c56" id="r_ab7b1f21c7017042806199c7858446c56"><td class="memItemLeft" align="right" valign="top"><a id="ab7b1f21c7017042806199c7858446c56" name="ab7b1f21c7017042806199c7858446c56"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>operator==</b> (<a class="el" href="structTransitionMatrix.html">TransitionMatrix</a> const &amp;) const =default</td></tr>
<tr class="separator:ab7b1f21c7017042806199c7858446c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a2b98bec1b4fd7c7776a564c372f469" id="r_a9a2b98bec1b4fd7c7776a564c372f469"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTransitionMatrix.html#a9a2b98bec1b4fd7c7776a564c372f469">initialize</a> ()</td></tr>
<tr class="memdesc:a9a2b98bec1b4fd7c7776a564c372f469"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the transition matrix and related data structures.  <br /></td></tr>
<tr class="separator:a9a2b98bec1b4fd7c7776a564c372f469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9767fecfe0973d0bb6b25beed413ecdb" id="r_a9767fecfe0973d0bb6b25beed413ecdb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTransitionMatrix.html#a9767fecfe0973d0bb6b25beed413ecdb">updateMatrix</a> (double3 Pacc, size_t oldN)</td></tr>
<tr class="memdesc:a9767fecfe0973d0bb6b25beed413ecdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the collection matrix with acceptance probabilities.  <br /></td></tr>
<tr class="separator:a9767fecfe0973d0bb6b25beed413ecdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68ff4dd34c9e12e404b64276fd2bd913" id="r_a68ff4dd34c9e12e404b64276fd2bd913"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTransitionMatrix.html#a68ff4dd34c9e12e404b64276fd2bd913">updateHistogram</a> (size_t N)</td></tr>
<tr class="memdesc:a68ff4dd34c9e12e404b64276fd2bd913"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the histogram of macrostate visits.  <br /></td></tr>
<tr class="separator:a68ff4dd34c9e12e404b64276fd2bd913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e82de61d604ada815beeaabdd01db09" id="r_a6e82de61d604ada815beeaabdd01db09"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTransitionMatrix.html#a6e82de61d604ada815beeaabdd01db09">biasFactor</a> (size_t newN, size_t oldN)</td></tr>
<tr class="memdesc:a6e82de61d604ada815beeaabdd01db09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the bias factor between two macrostates.  <br /></td></tr>
<tr class="separator:a6e82de61d604ada815beeaabdd01db09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac58ab554139e766556a05265ba529d33" id="r_ac58ab554139e766556a05265ba529d33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTransitionMatrix.html#ac58ab554139e766556a05265ba529d33">adjustBias</a> ()</td></tr>
<tr class="memdesc:ac58ab554139e766556a05265ba529d33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjusts the bias factors based on collected statistics.  <br /></td></tr>
<tr class="separator:ac58ab554139e766556a05265ba529d33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee862fe0ae56f0d464954bd428f9d06d" id="r_aee862fe0ae56f0d464954bd428f9d06d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTransitionMatrix.html#aee862fe0ae56f0d464954bd428f9d06d">clearCMatrix</a> ()</td></tr>
<tr class="memdesc:aee862fe0ae56f0d464954bd428f9d06d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the collection matrix and resets counters.  <br /></td></tr>
<tr class="separator:aee862fe0ae56f0d464954bd428f9d06d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c2fd5a0108fc6fbd796731279a9358" id="r_a93c2fd5a0108fc6fbd796731279a9358"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTransitionMatrix.html#a93c2fd5a0108fc6fbd796731279a9358">writeStatistics</a> ()</td></tr>
<tr class="memdesc:a93c2fd5a0108fc6fbd796731279a9358"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the transition matrix statistics to a file.  <br /></td></tr>
<tr class="separator:a93c2fd5a0108fc6fbd796731279a9358"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a9ad3a3f4719ffd1c1da3991ea9904cf0" id="r_a9ad3a3f4719ffd1c1da3991ea9904cf0"><td class="memItemLeft" align="right" valign="top"><a id="a9ad3a3f4719ffd1c1da3991ea9904cf0" name="a9ad3a3f4719ffd1c1da3991ea9904cf0"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>versionNumber</b> {1}</td></tr>
<tr class="memdesc:a9ad3a3f4719ffd1c1da3991ea9904cf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Version number for serialization compatibility. <br /></td></tr>
<tr class="separator:a9ad3a3f4719ffd1c1da3991ea9904cf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ada65031b63eab58f15b0908a1c1c2" id="r_ae7ada65031b63eab58f15b0908a1c1c2"><td class="memItemLeft" align="right" valign="top"><a id="ae7ada65031b63eab58f15b0908a1c1c2" name="ae7ada65031b63eab58f15b0908a1c1c2"></a>
std::vector&lt; double3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>cmatrix</b></td></tr>
<tr class="memdesc:ae7ada65031b63eab58f15b0908a1c1c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collection matrix: x=deletion, y=no change, z=insertion. <br /></td></tr>
<tr class="separator:ae7ada65031b63eab58f15b0908a1c1c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a845ce8195aea5bd7d2450fb31311c8a7" id="r_a845ce8195aea5bd7d2450fb31311c8a7"><td class="memItemLeft" align="right" valign="top"><a id="a845ce8195aea5bd7d2450fb31311c8a7" name="a845ce8195aea5bd7d2450fb31311c8a7"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>bias</b></td></tr>
<tr class="memdesc:a845ce8195aea5bd7d2450fb31311c8a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bias factors for each macrostate. <br /></td></tr>
<tr class="separator:a845ce8195aea5bd7d2450fb31311c8a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d052c97d0963b37ffdc3a0f4605405e" id="r_a9d052c97d0963b37ffdc3a0f4605405e"><td class="memItemLeft" align="right" valign="top"><a id="a9d052c97d0963b37ffdc3a0f4605405e" name="a9d052c97d0963b37ffdc3a0f4605405e"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>lnpi</b></td></tr>
<tr class="memdesc:a9d052c97d0963b37ffdc3a0f4605405e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Natural logarithm of the probability distribution. <br /></td></tr>
<tr class="separator:a9d052c97d0963b37ffdc3a0f4605405e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae936ea2f5161ba4735810885254876b2" id="r_ae936ea2f5161ba4735810885254876b2"><td class="memItemLeft" align="right" valign="top"><a id="ae936ea2f5161ba4735810885254876b2" name="ae936ea2f5161ba4735810885254876b2"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>forward_lnpi</b></td></tr>
<tr class="memdesc:ae936ea2f5161ba4735810885254876b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forward ln(pi) for debugging purposes. <br /></td></tr>
<tr class="separator:ae936ea2f5161ba4735810885254876b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fc3239b0df1dc3818c7d4754e1c6c77" id="r_a5fc3239b0df1dc3818c7d4754e1c6c77"><td class="memItemLeft" align="right" valign="top"><a id="a5fc3239b0df1dc3818c7d4754e1c6c77" name="a5fc3239b0df1dc3818c7d4754e1c6c77"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>reverse_lnpi</b></td></tr>
<tr class="memdesc:a5fc3239b0df1dc3818c7d4754e1c6c77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reverse ln(pi) for debugging purposes. <br /></td></tr>
<tr class="separator:a5fc3239b0df1dc3818c7d4754e1c6c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d80a256bbd3967dbf2e4b42c9c9f1b6" id="r_a7d80a256bbd3967dbf2e4b42c9c9f1b6"><td class="memItemLeft" align="right" valign="top"><a id="a7d80a256bbd3967dbf2e4b42c9c9f1b6" name="a7d80a256bbd3967dbf2e4b42c9c9f1b6"></a>
std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>histogram</b></td></tr>
<tr class="memdesc:a7d80a256bbd3967dbf2e4b42c9c9f1b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Histogram of macrostate visits. <br /></td></tr>
<tr class="separator:a7d80a256bbd3967dbf2e4b42c9c9f1b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05911234737520f785c23585e3dd3e96" id="r_a05911234737520f785c23585e3dd3e96"><td class="memItemLeft" align="right" valign="top"><a id="a05911234737520f785c23585e3dd3e96" name="a05911234737520f785c23585e3dd3e96"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>numberOfSteps</b> = {0}</td></tr>
<tr class="memdesc:a05911234737520f785c23585e3dd3e96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of steps performed in the TMMC simulation. <br /></td></tr>
<tr class="separator:a05911234737520f785c23585e3dd3e96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50948c061cd98ee8b0acb6a9828e2050" id="r_a50948c061cd98ee8b0acb6a9828e2050"><td class="memItemLeft" align="right" valign="top"><a id="a50948c061cd98ee8b0acb6a9828e2050" name="a50948c061cd98ee8b0acb6a9828e2050"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>minMacrostate</b> = {0}</td></tr>
<tr class="memdesc:a50948c061cd98ee8b0acb6a9828e2050"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum macrostate value. <br /></td></tr>
<tr class="separator:a50948c061cd98ee8b0acb6a9828e2050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa97a232f44c02eda56b0fe4b534b6c40" id="r_aa97a232f44c02eda56b0fe4b534b6c40"><td class="memItemLeft" align="right" valign="top"><a id="aa97a232f44c02eda56b0fe4b534b6c40" name="aa97a232f44c02eda56b0fe4b534b6c40"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>maxMacrostate</b> = {100}</td></tr>
<tr class="memdesc:aa97a232f44c02eda56b0fe4b534b6c40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum macrostate value. <br /></td></tr>
<tr class="separator:aa97a232f44c02eda56b0fe4b534b6c40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8242f35b99dc4cafca1ede518a33d0cf" id="r_a8242f35b99dc4cafca1ede518a33d0cf"><td class="memItemLeft" align="right" valign="top"><a id="a8242f35b99dc4cafca1ede518a33d0cf" name="a8242f35b99dc4cafca1ede518a33d0cf"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>updateTMEvery</b> = {1000000}</td></tr>
<tr class="memdesc:a8242f35b99dc4cafca1ede518a33d0cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of steps between bias updates. <br /></td></tr>
<tr class="separator:a8242f35b99dc4cafca1ede518a33d0cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41d6324e322702831cf5ec0315008b56" id="r_a41d6324e322702831cf5ec0315008b56"><td class="memItemLeft" align="right" valign="top"><a id="a41d6324e322702831cf5ec0315008b56" name="a41d6324e322702831cf5ec0315008b56"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>numberOfUpdates</b> = {0}</td></tr>
<tr class="memdesc:a41d6324e322702831cf5ec0315008b56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of times the bias has been updated. <br /></td></tr>
<tr class="separator:a41d6324e322702831cf5ec0315008b56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf3e1a5222534517e235b28abada545" id="r_abbf3e1a5222534517e235b28abada545"><td class="memItemLeft" align="right" valign="top"><a id="abbf3e1a5222534517e235b28abada545" name="abbf3e1a5222534517e235b28abada545"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>doTMMC</b> = {false}</td></tr>
<tr class="memdesc:abbf3e1a5222534517e235b28abada545"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether to perform TMMC simulation. <br /></td></tr>
<tr class="separator:abbf3e1a5222534517e235b28abada545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac513c7e4297099fe499d0a45966cd62e" id="r_ac513c7e4297099fe499d0a45966cd62e"><td class="memItemLeft" align="right" valign="top"><a id="ac513c7e4297099fe499d0a45966cd62e" name="ac513c7e4297099fe499d0a45966cd62e"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>useBias</b> = {false}</td></tr>
<tr class="memdesc:ac513c7e4297099fe499d0a45966cd62e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether to use bias for changing macrostates. <br /></td></tr>
<tr class="separator:ac513c7e4297099fe499d0a45966cd62e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2492d39f9199ec216051940a0a67a9d9" id="r_a2492d39f9199ec216051940a0a67a9d9"><td class="memItemLeft" align="right" valign="top"><a id="a2492d39f9199ec216051940a0a67a9d9" name="a2492d39f9199ec216051940a0a67a9d9"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>useTMBias</b> = {true}</td></tr>
<tr class="memdesc:a2492d39f9199ec216051940a0a67a9d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether to use Transition Matrix bias. <br /></td></tr>
<tr class="separator:a2492d39f9199ec216051940a0a67a9d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8386a4b54930d1648490e1a380460bfe" id="r_a8386a4b54930d1648490e1a380460bfe"><td class="memItemLeft" align="right" valign="top"><a id="a8386a4b54930d1648490e1a380460bfe" name="a8386a4b54930d1648490e1a380460bfe"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>rejectOutofBound</b> = {true}</td></tr>
<tr class="memdesc:a8386a4b54930d1648490e1a380460bfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether to reject moves outside macrostate bounds. <br /></td></tr>
<tr class="separator:a8386a4b54930d1648490e1a380460bfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22fb6652938f1ca85b2eea68b251fcb3" id="r_a22fb6652938f1ca85b2eea68b251fcb3"><td class="memItemLeft" align="right" valign="top"><a id="a22fb6652938f1ca85b2eea68b251fcb3" name="a22fb6652938f1ca85b2eea68b251fcb3"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>rezeroAfterInitialization</b> = {false}</td></tr>
<tr class="memdesc:a22fb6652938f1ca85b2eea68b251fcb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether to reset statistics after initialization. <br /></td></tr>
<tr class="separator:a22fb6652938f1ca85b2eea68b251fcb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a0d12c77460fe1473fe7c5b955d7f4aa4" id="r_a0d12c77460fe1473fe7c5b955d7f4aa4"><td class="memItemLeft" align="right" valign="top"><a id="a0d12c77460fe1473fe7c5b955d7f4aa4" name="a0d12c77460fe1473fe7c5b955d7f4aa4"></a>
Archive&lt; std::ofstream &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator&lt;&lt;</b> (Archive&lt; std::ofstream &gt; &amp;archive, const <a class="el" href="structTransitionMatrix.html">TransitionMatrix</a> &amp;m)</td></tr>
<tr class="separator:a0d12c77460fe1473fe7c5b955d7f4aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd6ef47596accfbe5be306ba116e1a8" id="r_a3cd6ef47596accfbe5be306ba116e1a8"><td class="memItemLeft" align="right" valign="top"><a id="a3cd6ef47596accfbe5be306ba116e1a8" name="a3cd6ef47596accfbe5be306ba116e1a8"></a>
Archive&lt; std::ifstream &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator&gt;&gt;</b> (Archive&lt; std::ifstream &gt; &amp;archive, <a class="el" href="structTransitionMatrix.html">TransitionMatrix</a> &amp;m)</td></tr>
<tr class="separator:a3cd6ef47596accfbe5be306ba116e1a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Represents the transition matrix for TMMC simulations. </p>
<p>The <a class="el" href="structTransitionMatrix.html" title="Represents the transition matrix for TMMC simulations.">TransitionMatrix</a> struct encapsulates the data and methods required for performing Transition Matrix Monte Carlo (TMMC) simulations. It maintains the collection matrix, bias factors, natural logarithm of probability distributions, and histograms to compute macrostates and adjust biases during the simulation. It provides methods to initialize data structures, update matrices and histograms, calculate bias factors, adjust biases, clear statistics, and write statistics to files. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ac58ab554139e766556a05265ba529d33" name="ac58ab554139e766556a05265ba529d33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac58ab554139e766556a05265ba529d33">&#9670;&#160;</a></span>adjustBias()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TransitionMatrix::adjustBias </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjusts the bias factors based on collected statistics. </p>
<p>Updates the bias vector and the natural logarithm of the probability distribution (lnpi) using the current state of the collection matrix and histogram. This method recalculates biases to improve sampling efficiency. </p>

</div>
</div>
<a id="a6e82de61d604ada815beeaabdd01db09" name="a6e82de61d604ada815beeaabdd01db09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e82de61d604ada815beeaabdd01db09">&#9670;&#160;</a></span>biasFactor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TransitionMatrix::biasFactor </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>newN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>oldN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the bias factor between two macrostates. </p>
<p>Computes the bias factor used to adjust the acceptance probability of moves between macrostates. The bias factor is calculated as the exponential of the difference in bias between the new and old macrostate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">newN</td><td>The macrostate value after the move. </td></tr>
    <tr><td class="paramname">oldN</td><td>The macrostate value before the move. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The bias factor for the transition from oldN to newN. </dd></dl>

</div>
</div>
<a id="aee862fe0ae56f0d464954bd428f9d06d" name="aee862fe0ae56f0d464954bd428f9d06d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee862fe0ae56f0d464954bd428f9d06d">&#9670;&#160;</a></span>clearCMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TransitionMatrix::clearCMatrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears the collection matrix and resets counters. </p>
<p>Resets the collection matrix, histogram, bias factors, and related counters to their initial values. Typically used after initialization cycles to reset statistics. </p>

</div>
</div>
<a id="a9a2b98bec1b4fd7c7776a564c372f469" name="a9a2b98bec1b4fd7c7776a564c372f469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a2b98bec1b4fd7c7776a564c372f469">&#9670;&#160;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TransitionMatrix::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the transition matrix and related data structures. </p>
<p>Sets up the collection matrix, bias vectors, and histograms based on the specified macrostate range. Initializes bias factors and probability distributions to default values. Should be called before starting the TMMC simulation. </p>

</div>
</div>
<a id="a68ff4dd34c9e12e404b64276fd2bd913" name="a68ff4dd34c9e12e404b64276fd2bd913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68ff4dd34c9e12e404b64276fd2bd913">&#9670;&#160;</a></span>updateHistogram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TransitionMatrix::updateHistogram </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>N</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the histogram of macrostate visits. </p>
<p>Increments the histogram count for the given macrostate N, tracking how often each macrostate is visited during the simulation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">N</td><td>The current macrostate value. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9767fecfe0973d0bb6b25beed413ecdb" name="a9767fecfe0973d0bb6b25beed413ecdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9767fecfe0973d0bb6b25beed413ecdb">&#9670;&#160;</a></span>updateMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TransitionMatrix::updateMatrix </td>
          <td>(</td>
          <td class="paramtype">double3&#160;</td>
          <td class="paramname"><em>Pacc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>oldN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the collection matrix with acceptance probabilities. </p>
<p>Records the probabilities of transitions between macrostates in the collection matrix. The acceptance probabilities vector Pacc contains probabilities for deletion (x), no change (y), and insertion (z) moves.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Pacc</td><td>A double3 vector containing acceptance probabilities for deletion (x), no change (y), and insertion (z) moves. </td></tr>
    <tr><td class="paramname">oldN</td><td>The macrostate value before the move. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a93c2fd5a0108fc6fbd796731279a9358" name="a93c2fd5a0108fc6fbd796731279a9358"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93c2fd5a0108fc6fbd796731279a9358">&#9670;&#160;</a></span>writeStatistics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TransitionMatrix::writeStatistics </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes the transition matrix statistics to a file. </p>
<p>Outputs the current state of the collection matrix, bias factors, probability distributions, and histogram data to a text file for analysis and debugging. </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>src/raspakit/properties/<b>transition_matrix.ixx</b></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structTransitionMatrix.html">TransitionMatrix</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
